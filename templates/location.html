<!DOCTYPE html>
<html lang="en">
  <script src="https://code.jquery.com/jquery-3.5.0.js"></script>
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>복지시설 위치</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
  integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <link rel="stylesheet" type="text/css" href="../static/location_style_1.css">
 
  
  <script>

    function sql_read(){
        $.ajax({ 
            type: "GET", 
            url: '/sql/read',
            success: function (response) {
                    alert('s')
                    map_list=response['map_list']
                    let positions = []
                    for (i = 0; i < map_list.length; i++) {
                temp_map = {
                  type: map_list[i][1],
                  title: map_list[i][0],
                  content: `<div>${map_list[i][0]}</div>`,
                  latlng: new kakao.maps.LatLng(map_list[i][8], map_list[i][7]),
                }
                positions[i]=temp_map
                
                
              }

                for (var i = 0; i < positions.length; i++) {
              // 마커 이미지의 이미지 크기 입니다
              var imageSize = new kakao.maps.Size(24, 35);
  
              // 마커 이미지를 생성합니다    
              var markerImage = new kakao.maps.MarkerImage(imageSrcRed, imageSize);
  
              // 마커를 생성합니다
              var marker = new kakao.maps.Marker({
                map: map, // 마커를 표시할 지도
                position: positions[i].latlng, // 마커를 표시할 위치
                title: positions[i].title, // 마커의 타이틀, 마커에 마우스를 올리면 타이틀이 표시됩니다
                image: markerImage // 마커 이미지 
              });
  
            }
              
                    alert(response["msg"])  
                },
            error: function (request, status, error) {
                    alert("에러발생");
                    
                }
        });

    }

    function openClose() {
        if ($("#list-items").css("display") == "block") {
            $("#list-items").hide();
            $("#btn-list-items").text("개인정보 열기");
        } else {
            $("#list-items").show();
            $("#btn-list-items").text("개인정보 닫기");
        }
    }


    function fnMove(seq) {
        var offset = $("#div" + seq).offset();
        $('html, body').animate({
            scrollTop: offset.top - 60 /*스크롤된 위치에서 상단네비 길이만큼 -60*/
        }, 400 /*스크롤시간*/ );
    }

    
</script>
</head>


<body>

  <div class="wrapper">
    <input type="checkbox" id="nav_btn" hidden>
    <label for="nav_btn" class="menu-btn">
        <i class="fas fa-user"></i>


        <!-- <i class="fas fa-times"></i> -->
    </label>
    <nav id="sidebar">
        <!-- <div class="title"><img src=imge/logo_02.gif></div> -->

        <button onclick="openClose()" id="btn-list-items" type="button" class="btn btn-info">개인정보 열기</button>

        <ul class="list-items" id="list-items" style="display:none">
            <!-- 입력창을 어떻게해줘야 db 넣기가 편한지 모름.. -->
            <li>로그인 해주세요!<button id="login_btn">로그인</button></li>
            <li>박 결님 (만 32세) </li>
            <li>관할 구청 : 은평구</li>
            <li>보호자 : 박현정 (복지사)</li>

            <li>내가 봤던 페이지 확인</li>
            <div id="nav_search_box">

                <a href="#">검색기록/길이확인중</a><br>
                <a href="#">검색기록/길이확인중</a><br>
                <a href="#">검색기록/길이확인중</a><br>
                <a href="#">검색기록/길이확인중</a><br>
                <a href="#">검색기록/길이확인중</a><br>
                <a href="#">검색기록/길이확인중</a><br>
                <a href="#">검색기록/길이확인중</a><br>
                <a href="#">검색기록/길이확인중</a><br>
            </div>
        </ul>
        <div id="nav-mainbtn">
            <button onClick="fnMove('1')" class="btn btn-outline-light">생활복지</button>
            <button onClick="fnMove('2')" class="btn btn-outline-light">의료복지</button>
            <button onClick="fnMove('3')" class="btn btn-outline-light">문화/여가</button>
            <button class="btn btn-outline-light">지도<a class="fas fa-map-marker-alt"></a></button>
        </div>
    </nav>
</div>

<!-- 로고& 네비게이션 메뉴 -->
  <div id="header">
    <img class="logo" src="../static/img/노른자logo_2.png">
    <ul class="main_menu">
      <li>About</li>
      <li>생활복지</li>
      <li>문화/여가</li>
      <li>의료복지</li>
      <li>복지지도</li>
    </ul>
  </div>


  <!-- 검색창 -->
  <div id="case">
    <div id="search-box">
        <input type="search" placeholder="검색어를 입력해주세요">
        <label class="icon">
          <i class="fas fa-search"></i>
        </label>
      </div>
    </div>

<!-- 본문내용 시작 -->
  <section id=contents>
      <div id="title">
      <p id="service_title">노른자 복지지도
        <img class="map_icon" src="../static/img/map.png">
      </p>
    </div>

  <!-- 기관분류 버튼   -->
    <div id="menu">
      <div class="buttons">
        <ul class="btn">
          <li>공공기관</li>
          <li>병원</li>
          <li>약국</li>
          <li>노인정</li>
        </ul>
      </div>
    </div>




  <!-- 지도영역 시작(지역선택버튼/ 지도결과 리스트 포함)  -->
    <div id="map">
      <div id="maplist">
      </div>
    </section>
  
    <section id="main">
      <div class=map>
        <p style="margin-top:0px">
          <b>Chrome 브라우저는 https 환경에서만 geolocation을 지원합니다.</b> 참고해주세요.
        </p>
        <div id="map" style="width:100%;height:100%;"></div>
        <script type="text/javascript"
          src="//dapi.kakao.com/v2/maps/sdk.js?appkey=35dde2f296a97b5ad171e7beb3bfb02c"></script>
        <script>
          // let j = 0
          // document.addEventListener("DOMContentLoaded", function () {
          
          //   j = 1;
          // })
  
          var mapContainer = document.getElementById('map'), // 지도를 표시할 div 
            mapOption = {
              center: new kakao.maps.LatLng(33.450701, 126.570667), // 지도의 중심좌표
              level: 1 // 지도의 확대 레벨 (1~) 숫자가 낮을수록 확대되어있음 (100이면 한반도 보임)
            };
  
          var map = new kakao.maps.Map(mapContainer, mapOption); // 지도를 생성합니다
            
          my_lat=''
          my_lon=''
          sql_read()
          
          

          // [
          //   {
          //     title: '카카오',
          //     content: '<div>카카오</div>',
          //     latlng: new kakao.maps.LatLng(33.450705, 126.570677)
          //   },
          //   {
          //     title: '생태연못',
          //     content: '<div>생태연못</div>',
          //     latlng: new kakao.maps.LatLng(33.450936, 126.569477)
          //   },
          //   {
          //     title: '텃밭',
          //     content: '<div>텃밭</div>',
          //     latlng: new kakao.maps.LatLng(33.450879, 126.569940)
          //   },
          //   {
          //     title: '근린공원',
          //     content: '<div>근린공원</div>',
          //     latlng: new kakao.maps.LatLng(33.451393, 126.570738)
          //   }
          // ];
  
          var imageSrcYellow = "https://petsa-test.s3.ap-northeast-2.amazonaws.com/markerStar.png";
  
          var imageSrcRed = "https://petsa-test.s3.ap-northeast-2.amazonaws.com/markerStarBlue.png";
  
          var imageSrcBlue = "https://petsa-test.s3.ap-northeast-2.amazonaws.com/markerStarRed.png";
  
          // if (j == 0) {
          //   j = j + 1
  
            
  
          // }
          // else {
          // }
  
          // HTML5의 geolocation으로 사용할 수 있는지 확인합니다 
          if (navigator.geolocation) {
  
            // GeoLocation을 이용해서 접속 위치를 얻어옵니다
            navigator.geolocation.getCurrentPosition(function (position) {
  
              var lat = position.coords.latitude, // 위도
                lon = position.coords.longitude; // 경도
              my_lat=lat
              my_lon=lon
  
              var locPosition = new kakao.maps.LatLng(lat, lon), // 마커가 표시될 위치를 geolocation으로 얻어온 좌표로 생성합니다
                message = '<div style="padding:5px;">현재위치 입니다.</div>'; // 인포윈도우에 표시될 내용입니다
  
              // 마커와 인포윈도우를 표시합니다
              displayMarker(locPosition, message);
  
            });
  
          } else { // HTML5의 GeoLocation을 사용할 수 없을때 마커 표시 위치와 인포윈도우 내용을 설정합니다
  
            var locPosition = new kakao.maps.LatLng(33.450701, 126.570667),
              message = 'geolocation을 사용할수 없어요..'
  
            displayMarker(locPosition, message);
          }
  
          // 지도에 마커와 인포윈도우를 표시하는 함수입니다
          function displayMarker(locPosition, message) {
  
            // 마커를 생성합니다
            var marker = new kakao.maps.Marker({
              map: map,
              position: locPosition
            });
  
            var iwContent = message, // 인포윈도우에 표시할 내용
              iwRemoveable = true;
  
            // 인포윈도우를 생성합니다
            var infowindow = new kakao.maps.InfoWindow({
              content: iwContent,
              removable: iwRemoveable
            });
  
            // 인포윈도우를 마커위에 표시합니다 
            infowindow.open(map, marker);
  
            // 지도 중심좌표를 접속위치로 변경합니다
            map.setCenter(locPosition);
          }
        </script>
      </div>
  
     <!-- 지도결과 리스트 아코디언메뉴 -->

      <div id="accordionExample">
        <input type="checkbox" id="answer01">
        <label for="answer01">지도 결과 리스트<img></img></label>
        <div class="maplist">
          <div class=location_card>
            <p>윰제이포도밭</p>
            <p>충청남도 천안이 어쩌고자쩌고 123-1234</p>
            <p>041-123-4567</p>
          </div>
          <div class=location_card>
            <p>윰제이포도밭</p>
            <p>충청남도 천안이 어쩌고자쩌고 123-1234</p>
            <p>041-123-4567</p>
          </div>
          <div class=location_card>
            <p>윰제이포도밭</p>
            <p>충청남도 천안이 어쩌고자쩌고 123-1234</p>
            <p>041-123-4567</p>
          </div>
          <div class=location_card>
            <p>윰제이포도밭</p>
            <p>충청남도 천안이 어쩌고자쩌고 123-1234</p>
            <p>041-123-4567</p>
          </div>
          <div class=location_card>
            <p>윰제이포도밭</p>
            <p>충청남도 천안이 어쩌고자쩌고 123-1234</p>
            <p>041-123-4567</p>
          </div>
        </div>
      </div>


     <!-- 지역선택 아코디언 메뉴 -->

      <div id="district_options">
        <input type="checkbox"  id="district">
        <label for="district">지역선택<img></img></label>
       <div class="district_list">
           <p>강남구</p>
           <p>강동구</p>
           <p>강북구</p>
           <p>강서구</p>
           <p>관악구</p>
           <p>광진구</p>
           <p>구로구</p>
           <p>금천구</p>
           <p>노원구</p>
           <p>도봉구</p>
           <p>동대문구</p>
           <p>동작구</p>
           <p>마포구</p>
           <p>서대문구</p>
           <p>서초구</p>
           <p>성동구</p>
           <p>성북구</p>
           <p>송파구</p>
           <p>양천구</p>
           <p>영등포구</p>
           <p>용산구</p>
           <p>은평구</p>
           <p>종로구</p>
           <p>중구</p>
           <p>중랑구</p>
         </div>
          </div>
    </div>
</section>

<!-- 푸터이미지 -->
  <footer class="footer">
    <img src="../static/img/footer_egg2.png">
  </footer>

</body>

</html>